<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>House Price Prediction System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üè† House Price Prediction System</h1>
            <p>Enter house features to predict the sale price</p>
        </header>

        <div class="main-content">
            <form id="predictionForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="overall_qual">Overall Quality (1-10):</label>
                        <input type="number" id="overall_qual" name="overall_qual" 
                               min="1" max="10" value="7" required>
                        <small>Rates the overall material and finish of the house</small>
                    </div>

                    <div class="form-group">
                        <label for="gr_liv_area">Living Area (sq ft):</label>
                        <input type="number" id="gr_liv_area" name="gr_liv_area" 
                               min="300" max="10000" value="1500" required>
                        <small>Above grade (ground) living area square feet</small>
                    </div>

                    <div class="form-group">
                        <label for="total_bsmt_sf">Basement Area (sq ft):</label>
                        <input type="number" id="total_bsmt_sf" name="total_bsmt_sf" 
                               min="0" max="6000" value="1000" required>
                        <small>Total square feet of basement area</small>
                    </div>

                    <div class="form-group">
                        <label for="garage_cars">Garage Size (cars):</label>
                        <input type="number" id="garage_cars" name="garage_cars" 
                               min="0" max="5" value="2" required>
                        <small>Size of garage in car capacity</small>
                    </div>

                    <div class="form-group">
                        <label for="year_built">Year Built:</label>
                        <input type="number" id="year_built" name="year_built" 
                               min="1800" max="2025" value="2005" required>
                        <small>Original construction date</small>
                    </div>

                    <div class="form-group">
                        <label for="neighborhood">Neighborhood:</label>
                        <select id="neighborhood" name="neighborhood" required>
                            {% for n in neighborhoods %}
                            <option value="{{ n }}">{{ n }}</option>
                            {% endfor %}
                        </select>
                        <small>Physical location within Ames city limits</small>
                    </div>
                </div>

                <button type="submit" class="btn-predict">
                    Predict Price
                </button>
            </form>

            <div id="result" class="result hidden">
                <h2>Prediction Result</h2>
                <div class="predicted-price">
                    <span class="price-label">Predicted Sale Price:</span>
                    <span id="predictedPrice" class="price-value">$0</span>
                </div>
                <div id="inputSummary" class="input-summary"></div>
            </div>

            <div id="error" class="error hidden">
                <h3>Error</h3>
                <p id="errorMessage"></p>
            </div>

            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Calculating price...</p>
            </div>
        </div>

        <footer>
            <p>Powered by Random Forest Regressor | Machine Learning Project</p>
        </footer>
    </div>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            
            const resultDiv = document.getElementById('result');
            const errorDiv = document.getElementById('error');
            const loadingDiv = document.getElementById('loading');
            
            resultDiv.classList.add('hidden');
            errorDiv.classList.add('hidden');
            loadingDiv.classList.remove('hidden');
            
            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                loadingDiv.classList.add('hidden');
                
                if (data.success) {
                    document.getElementById('predictedPrice').textContent = data.predicted_price;
                    
                    let summaryHTML = '<h3>Input Summary:</h3><ul>';
                    for (const [key, value] of Object.entries(data.inputs)) {
                        summaryHTML += `<li><strong>${key}:</strong> ${value}</li>`;
                    }
                    summaryHTML += '</ul>';
                    
                    document.getElementById('inputSummary').innerHTML = summaryHTML;
                    resultDiv.classList.remove('hidden');
                } else {
                    document.getElementById('errorMessage').textContent = data.error || 'An error occurred';
                    errorDiv.classList.remove('hidden');
                }
            } catch (error) {
                loadingDiv.classList.add('hidden');
                document.getElementById('errorMessage').textContent = 'Failed to connect to server';
                errorDiv.classList.remove('hidden');
            }
        });
    </script>
</body>
</html>